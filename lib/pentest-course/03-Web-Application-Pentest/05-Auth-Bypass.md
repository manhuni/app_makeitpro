Dưới đây là nội dung chi tiết cho bài học:

---

# 05. Auth Bypass

**Bypass xác thực người dùng**

---

## 🎯 Mục tiêu

* Hiểu các phương pháp phổ biến để vượt qua cơ chế xác thực (authentication).
* Biết cách phát hiện và khai thác lỗ hổng xác thực.
* Học các kỹ thuật phòng chống hiệu quả.

> Auth Bypass cho phép truy cập trái phép vào các chức năng chỉ dành cho người dùng đã xác thực – thường bằng cách lừa hệ thống bỏ qua quá trình kiểm tra đăng nhập.

---

## 📌 1. Xác thực là gì?

Authentication là quá trình xác minh danh tính người dùng, thường qua:

* Tên đăng nhập & mật khẩu
* Mã OTP / token / cookie / JWT
* Session hoặc cookie định danh

---

## 💥 2. Các kỹ thuật Bypass thường gặp

| Kỹ thuật                              | Mô tả                                                            |
| ------------------------------------- | ---------------------------------------------------------------- |
| **SQL Injection**                     | Bypass qua lỗ hổng SQL trong truy vấn đăng nhập.                 |
| **JWT Manipulation**                  | Giả mạo hoặc chỉnh sửa token JWT nếu không ký hoặc kiểm tra sai. |
| **Parameter Tampering**               | Thay đổi tham số URL/form để chuyển đổi vai trò người dùng.      |
| **Brute Force / Credential Stuffing** | Dò mật khẩu hoặc thử các mật khẩu rò rỉ.                         |
| **Logic Flaws**                       | Ví dụ: `/user/edit?id=2` truy cập được dữ liệu người khác.       |
| **Session Fixation**                  | Kẻ tấn công đặt trước session hợp lệ và lừa người dùng sử dụng.  |

---

## 🧪 3. Ví dụ minh họa

### 🔹 Bypass qua SQL Injection

```sql
SELECT * FROM users WHERE username = 'admin' AND password = '123' OR '1'='1'
```

→ Luôn trả về kết quả đúng, bỏ qua xác thực.

---

### 🔹 Thay đổi quyền người dùng

Giao diện admin:

```
http://site.com/profile?role=admin
```

→ Nếu ứng dụng chỉ dựa vào tham số `role`, ta có thể nâng quyền.

---

## 🔧 Công cụ kiểm thử

* **Burp Suite** (Repeater, Intruder)
* OWASP ZAP
* wfuzz / ffuf
* Hydra (brute force)
* Postman (kiểm tra token, header)

---

## 🔐 4. Cách phòng chống

| Biện pháp                           | Mô tả                                                   |
| ----------------------------------- | ------------------------------------------------------- |
| **Không tin tưởng input**           | Luôn lọc và kiểm tra dữ liệu từ người dùng.             |
| **Sử dụng prepared statements**     | Phòng chống SQLi khi xác thực.                          |
| **Mã hóa và ký JWT đúng cách**      | Không để `alg=none`, luôn xác thực chữ ký JWT.          |
| **Kiểm tra phân quyền phía server** | Không chỉ dựa vào tham số từ client.                    |
| **Giới hạn số lần đăng nhập**       | Tránh brute force, dùng CAPTCHA hoặc tạm khóa.          |
| **Không lộ lỗi debug**              | Không hiển thị lỗi SQL/stacktrace trên trang đăng nhập. |

---

## 🧠 Tổng kết

* Auth Bypass là mục tiêu chính của nhiều đợt tấn công vì cho phép truy cập trái phép.
* Lập trình viên cần kiểm soát kỹ các đường kiểm tra quyền và xác thực.
* Test kỹ cả logic ứng dụng chứ không chỉ kiểm tra mã nguồn hoặc lỗ hổng kỹ thuật.

---

Bạn có muốn tiếp theo là bài **06. File Inclusion (LFI/RFI)** không?
