DÆ°á»›i Ä‘Ã¢y lÃ  ná»™i dung chi tiáº¿t cho bÃ i há»c:

---

# 04. CSRF (Cross-Site Request Forgery)

**Táº¥n cÃ´ng giáº£ máº¡o yÃªu cáº§u tá»« trÃ¬nh duyá»‡t**

---

## ğŸ¯ Má»¥c tiÃªu

* Hiá»ƒu báº£n cháº¥t cá»§a CSRF vÃ  cÃ¡ch nÃ³ khai thÃ¡c trÃ¬nh duyá»‡t.
* Biáº¿t cÃ¡c tÃ¬nh huá»‘ng táº¥n cÃ´ng Ä‘iá»ƒn hÃ¬nh vÃ  háº­u quáº£.
* Náº¯m cÃ¡c ká»¹ thuáº­t phÃ²ng chá»‘ng CSRF hiá»‡u quáº£.

> CSRF Ä‘Ã¡nh lá»«a trÃ¬nh duyá»‡t thá»±c hiá»‡n hÃ nh Ä‘á»™ng trÃ¡i phÃ©p thay máº·t ngÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng nháº­p.

---

## ğŸ“Œ 1. CSRF lÃ  gÃ¬?

CSRF (Cross-Site Request Forgery) lÃ  táº¥n cÃ´ng Ã©p trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng **Ä‘Ã£ Ä‘Äƒng nháº­p** gá»­i yÃªu cáº§u Ä‘áº¿n má»™t trang web khÃ¡c mÃ  ngÆ°á»i dÃ¹ng cÃ³ quyá»n, mÃ  **khÃ´ng biáº¿t**.

VÃ­ dá»¥: khi ngÆ°á»i dÃ¹ng Ä‘ang Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n ngÃ¢n hÃ ng, káº» táº¥n cÃ´ng khiáº¿n trÃ¬nh duyá»‡t gá»­i lá»‡nh chuyá»ƒn tiá»n qua má»™t website trung gian.

---

## ğŸ’£ 2. VÃ­ dá»¥ minh há»a

### ğŸ”¹ TÃ¬nh huá»‘ng:

Báº¡n Ä‘Ã£ Ä‘Äƒng nháº­p vÃ o trang:

```
http://bank.com
```

Káº» táº¥n cÃ´ng gá»­i email chá»©a mÃ£ HTML sau:

```html
<img src="http://bank.com/transfer?to=attacker&amount=10000" />
```

â¡ï¸ TrÃ¬nh duyá»‡t váº«n gá»­i request nÃ y kÃ¨m theo cookie Ä‘Äƒng nháº­p há»£p lá»‡
â¡ï¸ Náº¿u khÃ´ng cÃ³ xÃ¡c thá»±c thÃªm, tiá»n sáº½ Ä‘Æ°á»£c chuyá»ƒn!

---

## ğŸ” 3. Äiá»u kiá»‡n Ä‘á»ƒ CSRF hoáº¡t Ä‘á»™ng

* NgÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng nháº­p vÃ  cookie váº«n cÃ²n hiá»‡u lá»±c.
* Server khÃ´ng cÃ³ biá»‡n phÃ¡p xÃ¡c thá»±c láº¡i yÃªu cáº§u (CSRF token).
* TrÃ¬nh duyá»‡t tá»± Ä‘á»™ng gá»­i cookie khi gá»i request tá»« trang khÃ¡c.

---

## ğŸ›¡ 4. CÃ¡ch phÃ²ng chá»‘ng CSRF

| Biá»‡n phÃ¡p                                                        | Giáº£i thÃ­ch                                                                   |
| ---------------------------------------------------------------- | ---------------------------------------------------------------------------- |
| **CSRF Token**                                                   | Gáº¯n mÃ£ token ngáº«u nhiÃªn vÃ o má»—i form hoáº·c request, kiá»ƒm tra láº¡i phÃ­a server. |
| **SameSite Cookie**                                              | Sá»­ dá»¥ng flag `SameSite=Strict` hoáº·c `Lax` Ä‘á»ƒ cháº·n gá»­i cookie tá»« bÃªn thá»© ba.  |
| **YÃªu cáº§u xÃ¡c thá»±c láº¡i hÃ nh vi nháº¡y cáº£m**                        | VÃ­ dá»¥: yÃªu cáº§u nháº­p láº¡i máº­t kháº©u hoáº·c xÃ¡c thá»±c OTP khi chuyá»ƒn tiá»n.          |
| **Sá»­ dá»¥ng POST thay vÃ¬ GET cho cÃ¡c hÃ nh vi thay Ä‘á»•i tráº¡ng thÃ¡i** | TrÃ¡nh GET gÃ¢y tÃ¡c Ä‘á»™ng há»‡ thá»‘ng (nhÆ° xoÃ¡, chuyá»ƒn tiá»n...).                   |

---

## âœ… VÃ­ dá»¥ vá» CSRF Token (HTML)

```html
<form action="/transfer" method="POST">
  <input type="hidden" name="csrf_token" value="abc123xyz">
  <input type="text" name="amount">
  <button type="submit">Chuyá»ƒn tiá»n</button>
</form>
```

PhÃ­a server sáº½ xÃ¡c minh token `abc123xyz` pháº£i Ä‘Ãºng vÃ  thuá»™c session hiá»‡n táº¡i.

---

## ğŸ”§ CÃ´ng cá»¥ kiá»ƒm thá»­ CSRF

* **Burp Suite** (cÃ³ tÃ­nh nÄƒng tÃ¬m CSRF)
* OWASP ZAP
* Postman (Ä‘á»ƒ gá»­i request thá»§ cÃ´ng kiá»ƒm tra)
* CÃ¡c á»©ng dá»¥ng luyá»‡n táº­p: DVWA, WebGoat

---

## ğŸ§  Tá»•ng káº¿t

* CSRF táº¥n cÃ´ng vÃ o **niá»m tin** cá»§a trang web Ä‘á»‘i vá»›i trÃ¬nh duyá»‡t ngÆ°á»i dÃ¹ng.
* DÃ¹ táº¥n cÃ´ng khÃ´ng phá»©c táº¡p nhÆ° XSS hay SQLi, háº­u quáº£ cÃ³ thá»ƒ ráº¥t nghiÃªm trá»ng.
* LuÃ´n xÃ¡c thá»±c láº¡i cÃ¡c hÃ nh Ä‘á»™ng quan trá»ng, sá»­ dá»¥ng CSRF token vÃ  cáº¥u hÃ¬nh cookie Ä‘Ãºng cÃ¡ch.

---

Báº¡n cÃ³ muá»‘n tiáº¿p theo lÃ  bÃ i **05. File Inclusion (LFI/RFI)** khÃ´ng?
