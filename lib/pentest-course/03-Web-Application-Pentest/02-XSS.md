Dưới đây là nội dung chi tiết cho bài học:

---

# 02. Tấn công XSS (Cross-Site Scripting)

**Cross-Site Scripting Explained**

## 🎯 Mục tiêu

* Hiểu rõ khái niệm, phân loại và tác động của XSS.
* Biết cách khai thác các dạng XSS khác nhau.
* Nắm được cách phòng tránh XSS cho lập trình viên và pentester.

> XSS cho phép kẻ tấn công chèn mã độc vào trang web mà trình duyệt nạn nhân sẽ thực thi — như thể đó là mã tin cậy.

---

## 🔍 1. XSS là gì?

XSS (Cross-Site Scripting) là lỗ hổng cho phép kẻ tấn công **chèn mã JavaScript độc hại** vào nội dung trang web được gửi đến trình duyệt của người dùng khác.

Kẻ tấn công có thể:

* Đánh cắp cookies, token phiên
* Chèn mã độc, redirect, hoặc keylogger
* Tấn công chuỗi (chain) với CSRF, phishing

---

## 🔬 2. Phân loại XSS

### 🧨 Stored XSS (XSS lưu trữ)

* Mã độc được lưu trong database/web server
* Hiển thị lại cho người dùng khi truy cập
* Ví dụ: bình luận, bài viết blog chứa JS độc hại

### 🚀 Reflected XSS (XSS phản chiếu)

* Mã độc nằm trong URL hoặc form và phản hồi ngay trong response
* Ví dụ:

  ```
  http://site.com/search?q=<script>alert(1)</script>
  ```

### 🕳 DOM-based XSS

* Ứng dụng xử lý dữ liệu đầu vào qua DOM (JS phía client)
* Không cần server phản hồi mã độc

---

## 🧪 3. Ví dụ thực tế

```html
<!-- Ví dụ phản chiếu XSS -->
<form action="/search">
  <input name="q" value="<!-- user input here -->">
</form>
```

Khi URL là:

```
/search?q=<script>alert(1)</script>
```

Trang sẽ hiển thị:

```html
<input name="q" value="<script>alert(1)</script>">
```

Kết quả: alert popup xuất hiện.

---

## 🔐 4. Cách phòng tránh

| Kỹ thuật                      | Mô tả                                         |
| ----------------------------- | --------------------------------------------- |
| Input Sanitization            | Loại bỏ ký tự đặc biệt (script, tag HTML)     |
| Output Encoding               | Encode HTML đặc biệt khi in ra (>, <, ", ')   |
| CSP (Content Security Policy) | Giới hạn nguồn thực thi script                |
| HTTPOnly cookie               | Bảo vệ cookie khỏi bị truy cập qua JavaScript |
| Sử dụng thư viện chống XSS    | DOMPurify, OWASP Java Encoder, v.v.           |

---

## 🧰 5. Công cụ hỗ trợ kiểm tra XSS

* Burp Suite (Community / Pro)
* OWASP ZAP
* XSS Hunter
* BeEF (Browser Exploitation Framework)
* Các môi trường luyện tập: DVWA, bWAPP, PortSwigger Labs

---

## 🧠 Tổng kết

* XSS là lỗ hổng phổ biến, nguy hiểm nhưng dễ bỏ sót.
* Luôn xem xét dữ liệu do người dùng cung cấp là không tin cậy.
* Kết hợp nhiều kỹ thuật phòng thủ để giảm thiểu rủi ro.

---

Bạn có muốn tiếp theo là bài **03. SQL Injection** không?
