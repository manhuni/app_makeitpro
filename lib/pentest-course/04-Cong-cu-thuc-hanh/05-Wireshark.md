Dưới đây là nội dung chi tiết cho bài học:

---

# 05. Wireshark

**Phân tích gói tin mạng trực quan và mạnh mẽ**

---

## 🎯 Mục tiêu

* Làm quen với giao diện và chức năng chính của Wireshark.
* Hiểu cách bắt, lọc và phân tích gói tin mạng.
* Nhận biết các vấn đề bảo mật và hoạt động bất thường trong hệ thống mạng.

---

## 📌 1. Wireshark là gì?

Wireshark là phần mềm mã nguồn mở dùng để **bắt và phân tích gói tin mạng (packet sniffing)**. Nó hỗ trợ:

* Giao diện đồ họa trực quan.
* Hàng trăm giao thức mạng: TCP/IP, HTTP, DNS, ARP, ICMP, SSL, v.v.
* Dùng để **phân tích lỗi**, **giám sát an ninh mạng**, hoặc **nghiên cứu**.

---

## 🛠 2. Cài đặt và khởi động

### ✅ Trên Kali Linux:

```bash
sudo wireshark
```

Chạy với quyền root hoặc thêm user vào nhóm `wireshark` để không cần sudo.

### ✅ Trên Windows/macOS:

* Tải tại: [https://www.wireshark.org/download.html](https://www.wireshark.org/download.html)

---

## 🌐 3. Bắt gói tin

1. Mở Wireshark → Chọn interface cần giám sát (ví dụ: `eth0`, `wlan0`)
2. Nhấn nút **Start Capturing Packets**
3. Gói tin sẽ hiện liên tục trên cửa sổ chính

---

## 🔍 4. Bộ lọc hiển thị (Display Filters)

| Bộ lọc                    | Ý nghĩa                                          |
| ------------------------- | ------------------------------------------------ |
| `ip.addr == 192.168.1.10` | Gói tin có địa chỉ IP nguồn/đích là 192.168.1.10 |
| `http`                    | Chỉ hiện các gói HTTP                            |
| `tcp.port == 80`          | Gói tin liên quan đến cổng TCP 80                |
| `dns`                     | Chỉ hiện truy vấn DNS                            |
| `icmp`                    | Chỉ hiện gói ICMP (ping)                         |
| `tcp.flags.syn == 1`      | Gói SYN (thiết lập kết nối TCP)                  |

---

## 🧪 5. Thực hành cơ bản

### 🔹 Kiểm tra kết nối HTTP:

1. Truy cập trang web từ trình duyệt.
2. Trong Wireshark, lọc: `http`
3. Chọn gói → Click phải → “Follow TCP Stream” để xem toàn bộ phiên kết nối.

### 🔹 Phân tích gói ping:

1. Mở terminal: `ping 8.8.8.8`
2. Lọc trong Wireshark: `icmp`

---

## 🛡 6. Ứng dụng trong bảo mật

* Phát hiện **dữ liệu nhạy cảm truyền không mã hóa** (username, password…)
* Nhận diện hoạt động lạ (port scanning, DoS, bất thường DNS…)
* Ghi log toàn bộ phiên giao tiếp nghi ngờ để điều tra sau.

---

## ⚙️ 7. Xuất và đọc file .pcap

* **Export Capture**: File → Export Specified Packets…
* Định dạng `.pcap` dùng để lưu và chia sẻ các gói tin.
* Có thể phân tích lại bất kỳ lúc nào, dùng chung với: `tcpdump`, `tshark`, etc.

---

## 📚 Mẹo sử dụng

* Dùng tính năng “Coloring Rules” để đánh dấu các gói đáng chú ý.
* Bookmark gói tin quan trọng bằng nút “Mark Packet”.
* Dùng “Statistics” → “Protocol Hierarchy” để tổng hợp nhanh.

---

## 🧠 Tổng kết

* Wireshark là công cụ **thiết yếu cho mọi kỹ sư mạng và pentester**.
* Sử dụng thành thạo bộ lọc và phân tích gói sẽ giúp bạn phát hiện và xử lý nhanh các sự cố bảo mật.
* Kết hợp với các công cụ như **tcpdump**, **Nmap**, **Burp Suite** trong quy trình pentest.

---

Bạn muốn tiếp tục với bài **06. Thực hành phân tích traffic độc hại với Wireshark** không?
