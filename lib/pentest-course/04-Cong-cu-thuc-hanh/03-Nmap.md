Dưới đây là nội dung chi tiết cho bài học:

---

# 03. Nmap

**Công cụ quét mạng và cổng mạnh mẽ nhất dành cho Pentester**

---

## 🎯 Mục tiêu

* Làm quen với Nmap và các chế độ quét.
* Hiểu cách phát hiện host, dịch vụ, hệ điều hành và lỗ hổng.
* Thực hành quét mạng nội bộ hoặc từ xa.

---

## 📌 1. Nmap là gì?

Nmap (Network Mapper) là công cụ mã nguồn mở chuyên dùng để:

* Quét địa chỉ IP và cổng mạng
* Phát hiện dịch vụ đang chạy (service detection)
* Phân tích hệ điều hành (OS detection)
* Kiểm tra lỗ hổng (với script NSE)

---

## 🔧 2. Cài đặt Nmap

Trên Kali Linux, Nmap đã được cài sẵn. Nếu cần cài:

```bash
sudo apt install nmap
```

---

## 🛠 3. Câu lệnh cơ bản

| Lệnh                         | Mô tả                                     |
| ---------------------------- | ----------------------------------------- |
| `nmap 192.168.1.1`           | Quét host đơn                             |
| `nmap 192.168.1.0/24`        | Quét toàn mạng con                        |
| `nmap -p 80,443 192.168.1.1` | Quét cổng cụ thể                          |
| `nmap -p- 192.168.1.1`       | Quét tất cả 65535 cổng                    |
| `nmap -sV 192.168.1.1`       | Phát hiện phiên bản dịch vụ               |
| `nmap -O 192.168.1.1`        | Phát hiện hệ điều hành                    |
| `nmap -A 192.168.1.1`        | Tổng hợp: OS detection + version + script |
| `nmap -sS 192.168.1.1`       | TCP SYN scan (stealth scan)               |

---

## ⚙️ 4. Nmap Scripting Engine (NSE)

Nmap có thể sử dụng các script để phát hiện và khai thác lỗ hổng.

Ví dụ:

```bash
nmap --script vuln 192.168.1.1
```

Một số script phổ biến:

* `http-title`: Lấy tiêu đề website
* `ftp-anon`: Kiểm tra đăng nhập ẩn danh FTP
* `smb-vuln*`: Kiểm tra lỗ hổng SMB

---

## 🔍 5. Thực hành

### 🔹 Bước 1: Xác định máy chủ đang hoạt động

```bash
nmap -sn 192.168.1.0/24
```

### 🔹 Bước 2: Quét dịch vụ chi tiết

```bash
nmap -sV -p- 192.168.1.100
```

### 🔹 Bước 3: Phát hiện lỗ hổng

```bash
nmap --script vuln -T4 192.168.1.100
```

---

## 📌 6. Tùy chọn hữu ích khác

| Tùy chọn        | Ý nghĩa                                      |
| --------------- | -------------------------------------------- |
| `-T0` đến `-T5` | Điều chỉnh tốc độ quét (T0: chậm, T5: nhanh) |
| `-Pn`           | Bỏ qua ping (khi host chặn ICMP)             |
| `-oN`, `-oX`    | Xuất kết quả ra file dạng txt hoặc XML       |

---

## 🛡 7. Cảnh báo và pháp lý

* **Chỉ quét hệ thống bạn được phép** – Nmap có thể bị xem là tấn công nếu dùng sai mục đích.
* Quét nhầm hệ thống thật có thể gây **bị khóa IP** hoặc **xử lý pháp lý**.

---

## 🧠 Tổng kết

* Nmap là công cụ thiết yếu cho mọi pentester.
* Nắm vững cú pháp và script NSE giúp bạn phát hiện lỗ hổng nhanh hơn.
* Kết hợp Nmap với các bước như khai thác, leo thang sau đó để hoàn chỉnh quy trình pentest.

---

Bạn muốn tiếp theo là bài **04. Nikto – Quét lỗ hổng web đơn giản** không?
